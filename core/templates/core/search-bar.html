{% load static %}
<!-- ========== BARRE DE RECHERCHE STICKY (pour autres pages) ========== -->
<div class="search-bar-container" id="search-bar-container" style="display: none;">
    <div class="search-bar-inner">
        <!-- 1. CHAMP ADRESSE -->
        <div class="search-field-address">
            <label class="search-field-address-label">Adresse</label>
            <div class="search-field-address-wrapper">
                <svg class="search-field-address-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                    <circle cx="12" cy="10" r="3"></circle>
                </svg>
                <input 
                    type="text" 
                    id="search-address-input" 
                    class="search-field-address-input" 
                    placeholder="Chercher une adresse..."
                    autocomplete="off"
                    spellcheck="false"
                    maxlength="255"
                >
                <button 
                    type="button" 
                    id="address-clear" 
                    class="search-field-address-clear"
                    aria-label="Effacer"
                >‚úï</button>
                <div id="address-autocomplete" class="address-autocomplete"></div>
            </div>
        </div>

        <!-- 2. CHAMP DATES -->
        <div class="search-field-dates">
            <label class="search-field-dates-label">Dates</label>
            <div class="search-field-dates-wrapper" id="search-dates-field">
                <svg class="search-field-dates-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="16" y1="2" x2="16" y2="6"></line>
                    <line x1="8" y1="2" x2="8" y2="6"></line>
                    <line x1="3" y1="10" x2="21" y2="10"></line>
                </svg>
                <span class="search-field-dates-display" id="date-display">S√©lectionner</span>
            </div>
        </div>

        <!-- 3. CHAMP BUDGET -->
        <div class="search-field-budget">
            <label class="search-field-budget-label">Budget</label>
            <div class="search-field-budget-wrapper" id="search-budget-field">
                <svg class="search-field-budget-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="12" y1="1" x2="12" y2="23"></line>
                    <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                </svg>
                <span class="search-field-budget-display" id="budget-display">Budget</span>
            </div>
        </div>

        <!-- 4. FILTRES AVANC√âS -->
        <div class="search-field-filters">
            <label class="search-field-filters-label">Filtres</label>
            <div class="search-field-filters-wrapper" id="search-filters-button">
                <svg class="search-field-filters-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
                </svg>
                <span class="search-field-filters-text">Filtres</span>
                <span class="search-field-filters-badge" id="filters-badge"></span>
            </div>
        </div>

        <!-- 5. BOUTON CHERCHER -->
        <button type="button" id="search-button" class="search-button" aria-label="Lancer la recherche">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="11" cy="11" r="8"></circle>
                <path d="m21 21-4.35-4.35"></path>
            </svg>
            CHERCHER
        </button>
    </div>
</div>

<!-- BARRE FILTRES ACTIFS -->
<div class="active-filters-bar" id="active-filters-bar">
    <div class="active-filters-container" id="active-filters-container"></div>
    <button type="button" class="active-filters-reset" onclick="resetAllFilters()">R√©initialiser tous</button>
</div>

<!-- ========== MODAL DATE PICKER ========== -->
<div class="modal-overlay" id="date-picker-overlay"></div>
<div class="date-picker-modal" id="date-picker-modal">
    <div class="date-picker-header">
        <h3 class="date-picker-title">Quand?</h3>
        <button type="button" class="date-picker-close" id="date-picker-close">‚úï</button>
    </div>
    <div class="date-picker-content">
        <div class="date-inputs-row">
            <div class="date-input-group">
                <label>D√©but</label>
                <input type="date" id="date-debut-input" class="date-input">
            </div>
            <div class="date-input-group">
                <label>Fin</label>
                <input type="date" id="date-fin-input" class="date-input">
            </div>
        </div>
        <div class="date-presets">
            <div class="date-presets-title">Ou s√©lectionner une dur√©e</div>
            <div class="date-presets-grid">
                <button type="button" class="date-preset" data-duration="1mois">1 mois</button>
                <button type="button" class="date-preset" data-duration="3mois">3 mois</button>
                <button type="button" class="date-preset" data-duration="6mois">6 mois</button>
                <button type="button" class="date-preset" data-duration="12mois">12 mois</button>
            </div>
        </div>
    </div>
    <div class="date-picker-actions">
        <button type="button" class="btn-secondary" onclick="document.getElementById('date-picker-modal').classList.remove('active')">Annuler</button>
        <button type="button" class="btn-primary" id="date-picker-apply">Appliquer</button>
    </div>
</div>

<!-- ========== MODAL BUDGET ========== -->
<div class="modal-overlay" id="budget-overlay"></div>
<div class="budget-modal" id="budget-modal">
    <div class="budget-header">
        <h3 class="budget-title">Budget</h3>
        <button type="button" class="budget-close" id="budget-close">‚úï</button>
    </div>
    <div class="budget-content">
        <div class="budget-inputs-row">
            <div class="date-input-group">
                <label>De :</label>
                <input type="number" id="budget-min-input" class="date-input" min="0" step="50" placeholder="500">
            </div>
            <div class="date-input-group">
                <label>√Ä :</label>
                <input type="number" id="budget-max-input" class="date-input" min="0" step="50" placeholder="2000">
            </div>
        </div>
        <div class="budget-slider-container">
            <input type="range" id="budget-min-slider" min="0" max="10000" step="50" value="0">
            <input type="range" id="budget-max-slider" min="0" max="10000" step="50" value="10000">
        </div>
        <div class="budget-presets">
            <div class="budget-presets-title">Budgets populaires</div>
            <div class="budget-presets-grid">
                <button type="button" class="budget-preset" data-range="0-600">Jusqu'√† 600‚Ç¨</button>
                <button type="button" class="budget-preset" data-range="600-800">600‚Ç¨ - 800‚Ç¨</button>
                <button type="button" class="budget-preset" data-range="800-1000">800‚Ç¨ - 1000‚Ç¨</button>
                <button type="button" class="budget-preset" data-range="1000-1500">1000‚Ç¨ - 1500‚Ç¨</button>
                <button type="button" class="budget-preset" data-range="1500-2000">1500‚Ç¨ - 2000‚Ç¨</button>
                <button type="button" class="budget-preset" data-range="2000+">2000‚Ç¨+</button>
            </div>
        </div>
    </div>
    <div class="date-picker-actions">
        <button type="button" class="btn-secondary" onclick="document.getElementById('budget-modal').classList.remove('active')">Annuler</button>
        <button type="button" class="btn-primary" id="budget-apply">Appliquer</button>
    </div>
</div>

<!-- ========== MODAL FILTRES AVANC√âS ========== -->
<div class="modal-overlay" id="filters-overlay"></div>
<div class="filters-modal" id="filters-modal">
    <div class="filters-header">
        <h2 class="filters-title">Filtres avanc√©s</h2>
        <button type="button" class="filters-close" id="filters-close">‚úï</button>
    </div>
    <div class="filters-content">
        <div class="filters-grid">
            <!-- COLONNE 1: TYPE DE BIEN -->
            <div class="filter-section">
                <div class="filter-section-title">TYPE DE BIEN</div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-type-appartement" value="appartement">
                    <label for="filter-type-appartement" class="filter-item-label">Appartement</label>
                    <span class="filter-item-count">(1240)</span>
                </div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-type-maison" value="maison">
                    <label for="filter-type-maison" class="filter-item-label">Maison</label>
                    <span class="filter-item-count">(856)</span>
                </div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-type-studio" value="studio">
                    <label for="filter-type-studio" class="filter-item-label">Studio</label>
                    <span class="filter-item-count">(423)</span>
                </div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-type-colocation" value="colocation">
                    <label for="filter-type-colocation" class="filter-item-label">Colocation</label>
                    <span class="filter-item-count">(187)</span>
                </div>
            </div>

            <!-- COLONNE 2: CARACT√âRISTIQUES -->
            <div class="filter-section">
                <div class="filter-section-title">CARACT√âRISTIQUES</div>
                <div class="filter-item">
                    <label class="filter-item-label">Pi√®ces</label>
                    <div class="filter-pill-group">
                        <button type="button" class="filter-pill" data-value="1">1</button>
                        <button type="button" class="filter-pill" data-value="2">2</button>
                        <button type="button" class="filter-pill" data-value="3">3</button>
                        <button type="button" class="filter-pill" data-value="4+">4+</button>
                    </div>
                </div>
                <div class="filter-item">
                    <label class="filter-item-label">Chambres</label>
                    <input type="range" min="0" max="5" value="0" id="filter-chambres-slider">
                </div>
                <div class="filter-item">
                    <label class="filter-item-label">Surface min (m¬≤)</label>
                    <input type="number" id="filter-surface-min" min="0" step="5" placeholder="50">
                </div>
            </div>

            <!-- COLONNE 3: √âQUIPEMENTS -->
            <div class="filter-section">
                <div class="filter-section-title">√âQUIPEMENTS</div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-equip-cuisine" value="cuisine_equipee">
                    <label for="filter-equip-cuisine" class="filter-item-label">Cuisine √©quip√©e</label>
                </div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-equip-parking" value="parking">
                    <label for="filter-equip-parking" class="filter-item-label">Parking</label>
                </div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-equip-balcon" value="balcon">
                    <label for="filter-equip-balcon" class="filter-item-label">Balcon / Terrasse</label>
                </div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-equip-wifi" value="wifi">
                    <label for="filter-equip-wifi" class="filter-item-label">WiFi</label>
                </div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-equip-clim" value="climatisation">
                    <label for="filter-equip-clim" class="filter-item-label">Climatisation</label>
                </div>
            </div>

            <!-- COLONNE 4: R√àGLES -->
            <div class="filter-section">
                <div class="filter-section-title">R√àGLES DE LOCATION</div>
                <div class="filter-item">
                    <label class="filter-item-label">üêæ Animaux</label>
                    <div class="filter-pill-group">
                        <button type="button" class="filter-pill" data-value="oui">Accept√©s</button>
                        <button type="button" class="filter-pill" data-value="non">Interdits</button>
                        <button type="button" class="filter-pill" data-value="nego">N√©gociable</button>
                    </div>
                </div>
                <div class="filter-item">
                    <label class="filter-item-label">üö¨ Fumeur</label>
                    <div class="filter-pill-group">
                        <button type="button" class="filter-pill" data-value="oui">Autoris√©</button>
                        <button type="button" class="filter-pill" data-value="non">Non autoris√©</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="filters-footer">
        <button type="button" class="btn-secondary" id="filters-reset">R√©initialiser tous les filtres</button>
        <button type="button" class="btn-primary" id="filters-apply">Appliquer les filtres</button>
    </div>
</div>

<!-- SCRIPTS -->
<!-- search-bar.js is already loaded in landing-page.html, no need to load it again -->
<script>
    // Reset all filters function
    function resetAllFilters() {
        if (typeof resetFilters === 'function') {
            resetFilters();
        }
        const bar = document.getElementById('active-filters-bar') || document.getElementById('active-filters-bar-hero');
        if (bar) bar.classList.remove('active');
        if (typeof performSearch === 'function') performSearch();
    }
    
    function resetAllFiltersHero() {
        resetAllFilters();
    }
    
    // Modal overlay handlers
    document.getElementById('date-picker-overlay')?.addEventListener('click', () => {
        document.getElementById('date-picker-modal').classList.remove('active');
    });
    
    document.getElementById('budget-overlay')?.addEventListener('click', () => {
        document.getElementById('budget-modal').classList.remove('active');
    });
    
    document.getElementById('filters-overlay')?.addEventListener('click', () => {
        document.getElementById('filters-modal').classList.remove('active');
    });
    
    // Sticky scroll effect
    window.addEventListener('scroll', () => {
        const container = document.getElementById('search-bar-container');
        if (window.scrollY > 10) {
            container.classList.add('scrolled');
        } else {
            container.classList.remove('scrolled');
        }
    });
</script>

